<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-fullscreen">
<title>ASCENT</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap');

  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  html, body {
    width: 100%; height: 100%;
    overflow: hidden;
    background: #0d0e16;
    touch-action: none;
    -webkit-user-select: none;
    user-select: none;
  }

  canvas {
    display: block;
    width: 100%;
    height: 100%;
    image-rendering: pixelated;
    image-rendering: crisp-edges;
  }

  #loading {
    position: fixed;
    inset: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    background: #0d0e16;
    z-index: 100;
    transition: opacity 0.8s ease;
    font-family: 'Share Tech Mono', 'Courier New', monospace;
  }

  #loading.hidden {
    opacity: 0;
    pointer-events: none;
  }

  .logo {
    font-size: clamp(48px, 14vw, 88px);
    font-weight: 900;
    letter-spacing: 0.15em;
    color: #e8e0d0;
    text-shadow:
      0 0 40px rgba(200, 160, 60, 0.8),
      0 0 80px rgba(200, 120, 20, 0.4),
      0 2px 0 #8a6020;
    animation: logoFloat 3s ease-in-out infinite;
    font-family: 'Share Tech Mono', monospace;
  }

  @keyframes logoFloat {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-8px); }
  }

  .tagline {
    color: #8a7a60;
    font-size: clamp(11px, 3vw, 15px);
    letter-spacing: 0.4em;
    margin-top: 12px;
    text-transform: uppercase;
  }

  .mountain-art {
    width: min(320px, 80vw);
    height: auto;
    margin: 28px 0;
    opacity: 0.85;
  }

  .progress-track {
    width: min(260px, 70vw);
    height: 4px;
    background: #1a1c2c;
    border-radius: 2px;
    overflow: hidden;
    margin-top: 8px;
  }

  .progress-fill {
    height: 100%;
    background: linear-gradient(90deg, #c87a30, #f0c050);
    border-radius: 2px;
    transition: width 0.3s ease;
    animation: progressLoad 1.4s ease forwards;
  }

  @keyframes progressLoad {
    from { width: 0%; }
    to { width: 100%; }
  }

  .load-text {
    color: #6a5a40;
    font-size: 11px;
    letter-spacing: 0.3em;
    margin-top: 14px;
    animation: blink 1.2s step-end infinite;
  }

  @keyframes blink {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.2; }
  }

  .tips {
    position: absolute;
    bottom: 36px;
    color: #4a4030;
    font-size: 10px;
    letter-spacing: 0.2em;
    text-align: center;
  }

  /* Touch areas - semi-transparent guides shown briefly */
  .control-hint {
    position: fixed;
    bottom: 20px;
    font-family: 'Share Tech Mono', monospace;
    font-size: 10px;
    color: rgba(200,180,120,0.4);
    letter-spacing: 0.2em;
    pointer-events: none;
    z-index: 10;
    display: none;
  }
  #hint-left { left: 20px; }
  #hint-right { right: 20px; }

  /* Retract button - always visible during game */
  #retract-btn {
    position: fixed;
    bottom: 24px;
    left: 50%;
    transform: translateX(-50%);
    width: 54px;
    height: 54px;
    border-radius: 50%;
    background: rgba(13, 14, 22, 0.7);
    border: 1.5px solid rgba(200, 160, 60, 0.5);
    color: rgba(200, 160, 60, 0.8);
    font-family: 'Share Tech Mono', monospace;
    font-size: 9px;
    letter-spacing: 0.1em;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    z-index: 10;
    user-select: none;
    -webkit-tap-highlight-color: transparent;
    transition: background 0.2s, border-color 0.2s;
  }

  #retract-btn:active {
    background: rgba(200, 120, 30, 0.25);
    border-color: #c87a30;
  }

  #retract-btn .icon {
    font-size: 20px;
    line-height: 1;
    color: #c8a050;
  }

  #retract-btn span {
    font-size: 8px;
    color: rgba(200,160,80,0.6);
    letter-spacing: 0.1em;
  }

  /* Left/Right movement buttons for non-touch or accessibility */
  .move-btn {
    position: fixed;
    bottom: 24px;
    width: 54px;
    height: 54px;
    border-radius: 12px;
    background: rgba(13, 14, 22, 0.6);
    border: 1.5px solid rgba(100, 120, 180, 0.3);
    color: rgba(140,160,220,0.7);
    font-size: 22px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    z-index: 10;
    -webkit-tap-highlight-color: transparent;
    user-select: none;
  }

  #btn-left { left: 24px; }
  #btn-right { left: 90px; }
  #btn-jump { left: 156px; }

  canvas { display: block; }
</style>
</head>
<body>

<!-- Loading Screen -->
<div id="loading">
  <div class="logo">ASCENT</div>
  <div class="tagline">Climb. Discover. Survive.</div>

  <!-- SVG mountain art -->
  <svg class="mountain-art" viewBox="0 0 320 160" xmlns="http://www.w3.org/2000/svg">
    <!-- Sky gradient -->
    <defs>
      <linearGradient id="sky" x1="0" y1="0" x2="0" y2="1">
        <stop offset="0%" stop-color="#05081a"/>
        <stop offset="100%" stop-color="#0d1830"/>
      </linearGradient>
      <linearGradient id="snowGrad" x1="0" y1="0" x2="0" y2="1">
        <stop offset="0%" stop-color="#e8f0f8"/>
        <stop offset="100%" stop-color="#c8d8e8"/>
      </linearGradient>
      <linearGradient id="rockGrad" x1="0" y1="0" x2="0" y2="1">
        <stop offset="0%" stop-color="#4a5060"/>
        <stop offset="100%" stop-color="#2a2e38"/>
      </linearGradient>
      <radialGradient id="moonGlow" cx="50%" cy="50%" r="50%">
        <stop offset="0%" stop-color="rgba(200,230,255,0.3)"/>
        <stop offset="100%" stop-color="rgba(0,0,0,0)"/>
      </radialGradient>
    </defs>
    <rect width="320" height="160" fill="url(#sky)"/>
    <!-- Stars -->
    <circle cx="30" cy="15" r="1" fill="rgba(200,220,255,0.8)"/>
    <circle cx="80" cy="8" r="1.5" fill="rgba(220,220,255,0.6)"/>
    <circle cx="130" cy="20" r="1" fill="rgba(200,220,255,0.7)"/>
    <circle cx="200" cy="12" r="1.5" fill="rgba(210,220,255,0.8)"/>
    <circle cx="260" cy="18" r="1" fill="rgba(200,220,255,0.5)"/>
    <circle cx="290" cy="8" r="1" fill="rgba(220,230,255,0.7)"/>
    <circle cx="310" cy="25" r="1" fill="rgba(200,220,255,0.4)"/>
    <!-- Moon -->
    <circle cx="280" cy="25" r="14" fill="url(#moonGlow)"/>
    <circle cx="280" cy="25" r="9" fill="rgba(220,235,255,0.9)"/>
    <circle cx="284" cy="22" r="7" fill="#0a1020"/>
    <!-- Far mountains (dark silhouettes) -->
    <path d="M0,110 L40,55 L80,90 L120,40 L160,75 L200,35 L240,70 L280,45 L320,80 L320,160 L0,160Z" fill="rgba(15,20,35,0.9)"/>
    <!-- Mid mountains -->
    <path d="M0,130 L50,85 L90,110 L140,65 L180,100 L230,60 L270,95 L320,75 L320,160 L0,160Z" fill="url(#rockGrad)"/>
    <!-- Main foreground mountain -->
    <path d="M60,160 L160,20 L260,160Z" fill="url(#rockGrad)"/>
    <!-- Snow cap -->
    <path d="M145,40 L160,20 L175,40 L170,55 L150,52Z" fill="url(#snowGrad)"/>
    <!-- Mountain detail lines (rock strata) -->
    <path d="M100,130 L130,90 L160,70 L190,90 L220,130" fill="none" stroke="rgba(80,90,110,0.5)" stroke-width="1"/>
    <path d="M110,150 L140,110 L160,95 L180,110 L210,150" fill="none" stroke="rgba(80,90,110,0.3)" stroke-width="1"/>
    <!-- Trees -->
    <rect x="88" y="128" width="4" height="12" fill="#3a2a18"/>
    <path d="M90,100 L82,128 L98,128Z" fill="#2a6a25"/>
    <path d="M90,112 L83,128 L97,128Z" fill="#357030"/>
    <rect x="218" y="125" width="4" height="14" fill="#3a2a18"/>
    <path d="M220,98 L212,125 L228,125Z" fill="#2a6a25"/>
    <path d="M220,110 L213,125 L227,125Z" fill="#357030"/>
    <!-- Small hut on ledge -->
    <rect x="104" y="110" width="28" height="18" fill="#3a2a18"/>
    <path d="M101,110 L118,98 L135,110Z" fill="#2a1a0a"/>
    <rect x="113" y="114" width="8" height="14" fill="#1a0a00"/>
    <!-- Warm window -->
    <rect x="107" y="113" width="6" height="5" fill="rgba(255,180,60,0.8)"/>
    <!-- Rope climber (tiny figure) -->
    <rect x="159" y="65" width="3" height="6" fill="#4a5a7a"/>
    <circle cx="160" cy="63" r="2.5" fill="#c4846a"/>
    <!-- Rope -->
    <path d="M161,56 Q163,60 161,65" fill="none" stroke="#c8a050" stroke-width="1.5"/>
    <circle cx="162" cy="55" r="2" fill="#d4a040"/>
    <!-- Foreground ground -->
    <rect x="0" y="154" width="320" height="6" fill="#d8e8f2"/>
    <!-- Vignette -->
    <radialGradient id="vig" cx="50%" cy="50%" r="70%">
      <stop offset="0%" stop-color="rgba(0,0,0,0)"/>
      <stop offset="100%" stop-color="rgba(0,0,0,0.5)"/>
    </radialGradient>
    <rect width="320" height="160" fill="url(#vig)"/>
  </svg>

  <div class="progress-track">
    <div class="progress-fill"></div>
  </div>
  <div class="load-text">GENERATING MOUNTAIN...</div>

  <div class="tips">DRAG right side to aim · RELEASE to throw · HOOK stone to climb</div>
</div>

<!-- Game Canvas -->
<canvas id="c"></canvas>

<!-- Retract rope button -->
<div id="retract-btn" onclick="if(window.Game && Game.rope) { Physics.retractRope(Game.rope); Game.player.onRope = false; }">
  <div class="icon">↩</div>
  <span>RETRACT</span>
</div>

<!-- Mobile movement buttons -->
<div class="move-btn" id="btn-left"
  ontouchstart="Game.input.left=true"
  ontouchend="Game.input.left=false"
  onmousedown="Game.input.left=true"
  onmouseup="Game.input.left=false">◀</div>
<div class="move-btn" id="btn-right"
  ontouchstart="Game.input.right=true"
  ontouchend="Game.input.right=false"
  onmousedown="Game.input.right=true"
  onmouseup="Game.input.right=false">▶</div>
<div class="move-btn" id="btn-jump"
  ontouchstart="Game.input.jump=true;setTimeout(()=>Game.input.jump=false,150)"
  onmousedown="Game.input.jump=true;setTimeout(()=>Game.input.jump=false,150)">▲</div>

<!-- Scripts in order -->
<script src="world.js"></script>
<script src="physics.js"></script>
<script src="entities.js"></script>
<script src="ui.js"></script>
<script src="game.js"></script>

<script>
  // Hide loading screen after world generates
  window.addEventListener('load', function() {
    setTimeout(function() {
      document.getElementById('loading').classList.add('hidden');
      setTimeout(() => document.getElementById('loading').remove(), 900);
    }, 1600);
  });

  // Prevent context menu on long press
  document.addEventListener('contextmenu', e => e.preventDefault());
  document.addEventListener('touchmove', e => e.preventDefault(), { passive: false });
</script>

</body>
</html>
